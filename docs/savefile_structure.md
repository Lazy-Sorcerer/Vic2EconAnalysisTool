# Victoria 2 Save File Structure

This document describes the structure of Victoria 2 save files (.v2) with a focus on economic data.

Save files use a Paradox-style text format with key-value pairs and nested blocks using curly braces `{}`.

## File Header

```
date="1870.1.1"           # Current in-game date
player="TAG"              # Player country tag (3-letter code)
government=7              # Government type ID
start_date="1836.1.1"     # Campaign start date
start_pop_index=360771    # Internal POP indexing
```

## World Market

The `worldmarket` block contains global economic data:

### worldmarket_pool
Current quantity of each good available on the world market.
```
worldmarket_pool={
    ammunition=64.30264
    cotton=694.22775
    coal=972.00687
    ...
}
```

### price_pool
Current market prices for each good.
```
price_pool={
    ammunition=18.11060
    cotton=2.06006
    coal=2.59027
    ...
}
```

### supply_pool
Total supply of each good entering the market.

### last_supply_pool
Supply from the previous tick.

### last_price_history
Previous tick's prices.

### price_history
Historical price data (multiple blocks, one per recorded period).

### actual_sold / actual_sold_world
Quantities of goods actually sold domestically and on the world market.

---

## Provinces

Provinces are numbered blocks (e.g., `1=`, `2=`, etc.):

```
1={
    name="Sitka"
    owner="USA"              # Country tag that owns province
    controller="USA"         # Country tag controlling province
    core="USA"               # Countries with cores (can appear multiple times)
    garrison=100.000         # Garrison strength
    nationalism=19.585       # Nationalism level (affects unrest)
    colonial=2               # Colonial status (0=state, 1=colonial, 2=territory)
    life_rating=20           # Base population growth modifier
    infrastructure=0.320     # Railroad level (0-1 scale)
    last_imigration="1869.7.14"
    ...
}
```

### RGO (Resource Gathering Operation)

Each province has an RGO block describing its primary resource production:

```
rgo={
    employment={
        province_id=1
        employees={
            {
                province_pop_id={
                    province_id=1
                    index=0
                    type=9        # POP type ID (9=slaves, 8=farmers, etc.)
                }
                count=636         # Number of POPs employed
            }
            ...
        }
    }
    last_income=21035.88867       # Income from last production cycle
    goods_type="precious_metal"   # Resource type produced
}
```

**Economic relevance:**
- `last_income`: Revenue generated by the RGO
- `count` in employees: Number of POPs employed (compare to total POP size for employment rate)
- `goods_type`: Determines what resource the province produces

---

## POPs (Population Units)

POPs are nested within province blocks, grouped by type:

### POP Types
- `aristocrats` - Landowners, receive RGO profits
- `artisans` - Independent craftsmen
- `bureaucrats` - Government administrators
- `capitalists` - Factory owners, investors
- `clergymen` - Religious figures
- `clerks` - White-collar factory workers
- `craftsmen` - Factory workers (blue-collar)
- `farmers` - Agricultural workers (RGO)
- `labourers` - Mining/resource workers (RGO)
- `officers` - Military officers
- `soldiers` - Military enlisted
- `slaves` - Enslaved workers

### POP Structure

```
craftsmen={
    id=347640                     # Unique POP ID
    size=46                       # Population count
    yankee=protestant             # culture=religion
    money=2.24399                 # Cash savings

    ideology={                    # Political ideology distribution (%)
        2=12.61887                # ID=percentage
        3=39.40448
        4=12.30020
        6=35.67636
    }

    issues={                      # Political issues positions
        1=3.97040
        2=10.49323
        ...
    }

    con=0.01050                   # Consciousness (0-10 scale)
    mil=0.27917                   # Militancy (0-10 scale, may be absent if 0)
    literacy=0.60864              # Literacy rate (0-1)
    bank=0.02472                  # Bank savings

    # Needs satisfaction (0-1 scale, 1=fully satisfied)
    life_needs=0.00000            # Basic survival needs
    everyday_needs=0.00000        # Standard living needs
    luxury_needs=0.06866          # Luxury goods consumption

    con_factor=0.00043            # Consciousness growth factor
    promoted=1                    # POPs promoted to higher strata
    demoted=1                     # POPs demoted to lower strata
    converted=12                  # POPs that changed religion/culture
    days_of_loss=2                # Days without meeting life needs
    random=8                      # RNG seed
}
```

### Artisan-Specific Fields

Artisans have additional production data:

```
artisans={
    ...
    production_type="artisan_lumber"    # What they produce
    stockpile={                          # Input goods in stock
        timber=0.54568
    }
    need={                               # Input goods needed
        timber=0.59549
    }
    last_spending=521.33527              # Money spent on inputs
    current_producing=0.00583            # Current production rate
    percent_afforded=0.91193             # % of inputs they could afford
    percent_sold_domestic=0.00131        # % sold domestically
    percent_sold_export=0.60242          # % sold on world market
    leftover=0.41449                     # Unsold goods
    throttle=0.14999                     # Production throttle
    needs_cost=571.68579                 # Cost of inputs
    production_income=506.98853          # Income from sales
}
```

**Key economic indicators:**
- `money`: POP's liquid cash (sum across all POPs = total money owned by POPs)
- `bank`: POP's bank savings
- `size`: Population count
- `life_needs`, `everyday_needs`, `luxury_needs`: Needs satisfaction (economic wellbeing)
- `days_of_loss`: Indicator of economic hardship

---

## Countries

Countries are identified by 3-letter tags (e.g., `ENG=`, `USA=`, `FRA=`):

### Basic Country Data

```
ENG={
    tax_base=17146.42609          # Tax base value
    capital=300                   # Capital province ID
    civilized=yes                 # Civilized status (yes/no)

    prestige=437.223              # Prestige score (part of ranking)
    badboy=15.653                 # Infamy (aggression score)

    money=12457564.00534          # TREASURY - national funds

    bank={
        money=340902.86096        # National bank reserves
        money_lent=10909.98212    # Money lent to POPs/businesses
    }

    plurality=100.000             # Political plurality
    revanchism=0.000              # Revanchism level
    ...
}
```

### Taxation

```
rich_tax={
    current=0.50272               # Current tax rate (0-1)
    tax_income={                  # Income by POP type (array)
        0.00000 960170.92804 0.00000 ...
    }
    tax_eff={                     # Tax efficiency by POP type
        0.00000 1906803.91275 0.00000 ...
    }
    total=3331747.72415           # Total tax income from rich
    rangeLimitMax=1.00000
    rangeLimitMin=0.00000
    max_tax=23
    min_tax=22
}

middle_tax={ ... }
poor_tax={ ... }
```

### Government Spending

```
education_spending={
    settings=0.75000              # Budget slider (0-1)
    temp_settings=0.74997
    factor=0.00998
    reserve=0.00000
    maxValue=1206370.67108        # Maximum possible spending
    ...
}

crime_fighting={ ... }
social_spending={ ... }
military_spending={ ... }
```

### Budget Tracking

```
expenses={
    0.00000 0.00000 0.00000 ...   # Array of expense categories
}
incomes={
    0.00000 0.00000 0.00000 ...   # Array of income categories
}
```

### National Stockpile

```
stockpile={
    ammunition=4.22202
    small_arms=0.98935
    artillery=3.94818
    canned_food=7.40109
    ...
}
```

### Trade

```
trade={
    ammunition={
        limit=4.22202             # Stockpile limit
        buy=yes                   # Currently buying
        automate_trade=yes        # AI-managed
    }
    ...
}
```

### Domestic Market

```
domestic_supply_pool={ ... }      # Goods produced domestically
sold_supply_pool={ ... }          # Goods sold
domestic_demand_pool={ ... }      # Domestic demand
actual_sold_domestic={ ... }      # Actually sold domestically
saved_country_supply={ ... }
max_bought={ ... }
```

### Foreign Investment

```
foreign_investment={
    0.00000 0.00000 1740878.03329 0.00000 ...  # Investment by country index
}
```

### Reforms

```
wage_reform=low_minimum_wage
work_hours=no_work_hour_limit
safety_regulations=low_safety
unemployment_subsidies=trinket_subsidies
pensions=no_pensions
health_care=trinket_health_care
school_reforms=good_schools
slavery=no_slavery
vote_franschise=universal_voting
upper_house_composition=appointed
voting_system=first_past_the_post
public_meetings=yes_meeting
press_rights=free_press
trade_unions=non_socialist
political_parties=secret_ballots
```

### Technology

```
technology={
    post_napoleonic_thought={1 0.000}    # {level progress}
    private_banks={1 0.000}
    stock_exchange={1 0.000}
    organized_factories={1 0.000}
    ...
}

research={
    technology=time_saving_measures      # Currently researching
    cost=182.648
    max_producing=11231.000
    last_spending=25.489
    active=yes
}
```

### Upper House

```
upper_house={
    reactionary=0.09369
    conservative=0.33499
    socialist=0.17307
    liberal=0.39819
}
```

### Diplomatic Relations

Within country blocks, relations with other countries:

```
RUS={
    value=32                      # Opinion (-200 to +200)
    last_send_diplomat="1867.12.26"
    last_war="1865.2.9"
    truce_until="1871.2.9"
}

DEN={
    value=1
    level=4                       # Sphere level (1-5)
    level_changed_date="1864.10.28"
    influence_value=8.060         # Influence points
    discredit="1870.2.15"         # Discredit until date
    discreditor="GER"             # Who discredited
}

NET={
    value=185
    military_access=yes           # Has military access
}
```

---

## States and Factories

States group provinces and contain factories:

```
state={
    id={
        id=606
        type=47
    }
    provinces={
        74 75 76 2625             # Province IDs in state
    }
    is_colonial=2                 # Colonial status
    savings=35.93335              # State treasury
    interest=91.39157             # Interest payments
    flashpoint=yes                # Crisis flashpoint
    crisis="QUE"                  # Crisis target tag

    state_buildings={
        building="machine_parts_factory"
        level=1                   # Factory level (1-99 theoretical)

        stockpile={               # Input goods in stock
            coal=0.75806
            steel=1.36450
            cement=0.07581
            machine_parts=0.00757
        }

        employment={
            state_province_id=74
            employees={
                {
                    province_pop_id={
                        province_id=74
                        index=0
                        type=6    # Clerks
                    }
                    count=256
                }
                {
                    province_pop_id={
                        province_id=74
                        index=0
                        type=7    # Craftsmen
                    }
                    count=629
                }
                ...
            }
        }

        money=1000000.00000       # Factory treasury
        last_spending=10287.90283 # Spending on inputs
        last_income=18124.84741   # Revenue from sales
        pops_paychecks=1974.54266 # Wages paid
        last_investment=0.00000   # Investment received
        unprofitable_days=0       # Days without profit
        subsidised=yes            # Receiving subsidies
        leftover=0.16739          # Unsold goods
        injected_money=0.00000    # Money injected
        injected_days=0
        produces=0.34946          # Production output

        profit_history_days=7
        profit_history_current=5
        profit_history_entry={
            1.21548 5.77237 5.69702 5.74222 5.73959 1.02469 1.24670
        }
    }
}
```

**Factory economic indicators:**
- `money`: Factory's cash reserves
- `last_income`: Revenue from last cycle
- `last_spending`: Input costs
- `pops_paychecks`: Wages paid to workers
- `unprofitable_days`: Economic health indicator
- `produces`: Current production rate
- Employee counts by type (craftsmen vs clerks)

---

## Military

### Leaders

```
leader={
    name="Fairfax Butler"
    date="1869.10.2"              # Assignment date
    type=land                     # land or sea
    personality="bigoted"
    background="hated"
    country="ENG"
    picture="european_general_31"
    prestige=0.031
    id={
        id=6665
        type=37
    }
}
```

### Regiments (in provinces)

```
name="1st Nashville Engineer"
type="engineer"
unit={
    id=21890
    type=4713
}
regiment={
    id=21891
    type=4713
}
pop={                             # POP providing soldiers
    id=25638
    type=46
}
count=1
rally_point=-1
```

---

## Wars

### Active Wars

```
active_war={
    name="Persian Conquest of Western Afghanistan"
    history={
        1867.4.5={
            add_attacker="PER"
        }
        1867.4.5={
            add_defender="AFG"
        }
        1867.7.21={
            battle={
                name="Birjand"
                location=1148     # Province ID
                result=yes        # Attacker won
                attacker={
                    country="PER"
                    leader="Karim Esfahani"
                    infantry=18000
                    losses=8816
                }
                defender={
                    country="AFG"
                    leader="Nasr Allah Khan"
                    irregular=12000
                    losses=3796
                }
            }
        }
    }
}
```

### Previous Wars

Same structure as active wars but under `previous_war=`.

---

## Key Economic Statistics Summary

| Statistic | Location | Path |
|-----------|----------|------|
| National Treasury | Country block | `money=` |
| National Bank Reserves | Country block | `bank={ money= }` |
| Prestige | Country block | `prestige=` |
| Infamy | Country block | `badboy=` |
| Tax Income | Country block | `rich_tax/middle_tax/poor_tax={ total= }` |
| POP Money | POP blocks | `money=` (sum all POPs) |
| POP Bank Savings | POP blocks | `bank=` (sum all POPs) |
| Needs Satisfaction | POP blocks | `life_needs=`, `everyday_needs=`, `luxury_needs=` |
| RGO Income | Province RGO block | `last_income=` |
| RGO Employment | Province RGO block | `employees={ count= }` |
| Factory Income | State factory block | `last_income=` |
| Factory Employment | State factory block | `employees={ count= }` by type |
| Factory Profitability | State factory block | `unprofitable_days=` |
| Wages Paid | State factory block | `pops_paychecks=` |
| World Market Prices | worldmarket block | `price_pool=` |
| Goods Supply | worldmarket block | `supply_pool=` |

### Calculating Unemployment

Unemployment is not stored directly. Calculate it by:
1. Sum total POP sizes for craftsmen/labourers/clerks in a state
2. Sum employed counts from factory `employment=` blocks
3. Unemployed = Total POP size - Employed count

### POP Type IDs (for employment blocks)

| ID | Type |
|----|------|
| 0 | aristocrats |
| 1 | artisans |
| 2 | bureaucrats |
| 3 | capitalists |
| 4 | clergymen |
| 5 | clerks |
| 6 | clerks (alternate) |
| 7 | craftsmen |
| 8 | farmers |
| 9 | labourers/slaves |
| 10 | officers |
| 11 | soldiers |

---

## Notes

- **Encoding**: Save files use Latin-1 (ISO-8859-1) encoding
- **Line endings**: Windows-style (CRLF)
- **Numbers**: Floating point with up to 5 decimal places
- **Dates**: Format is "YYYY.M.D" (no leading zeros)
- **Arrays**: Space-separated values within braces
- **IDs**: Internal reference system using id/type pairs
